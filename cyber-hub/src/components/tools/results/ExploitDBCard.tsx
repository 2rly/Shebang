"use client";

import { ExternalLink } from "lucide-react";
import type { ExploitDBResult } from "@/types/intelligence";

export function ExploitDBCard({ data }: { data: ExploitDBResult }) {
  return (
    <div className="space-y-3">
      <p className="text-xs text-cyber-muted">
        Found <span className="text-cyber-warning font-mono">{data.total}</span> exploit(s)
      </p>

      {data.exploits.length > 0 && (
        <div className="overflow-x-auto">
          <table className="w-full text-xs">
            <thead>
              <tr className="text-cyber-muted border-b border-cyber-border">
                <th className="text-left py-1.5 px-2 font-medium">Title</th>
                <th className="text-left py-1.5 px-2 font-medium">Date</th>
                <th className="text-left py-1.5 px-2 font-medium">Author</th>
                <th className="text-left py-1.5 px-2 font-medium">Type</th>
                <th className="text-left py-1.5 px-2 font-medium">Platform</th>
                <th className="text-left py-1.5 px-2 font-medium w-8"></th>
              </tr>
            </thead>
            <tbody>
              {data.exploits.map((exploit) => (
                <tr key={exploit.id} className="border-b border-cyber-border/30 hover:bg-cyber-border/20">
                  <td className="py-1.5 px-2 text-cyber-text max-w-[200px] truncate">{exploit.title}</td>
                  <td className="py-1.5 px-2 text-cyber-muted font-mono whitespace-nowrap">{exploit.date}</td>
                  <td className="py-1.5 px-2 text-cyber-muted truncate max-w-[100px]">{exploit.author}</td>
                  <td className="py-1.5 px-2">
                    <span className="cyber-tag text-[10px]">{exploit.type}</span>
                  </td>
                  <td className="py-1.5 px-2">
                    <span className="cyber-tag text-[10px]">{exploit.platform}</span>
                  </td>
                  <td className="py-1.5 px-2">
                    {exploit.url && (
                      <a
                        href={exploit.url}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-cyber-secondary hover:text-cyber-primary"
                      >
                        <ExternalLink className="w-3 h-3" />
                      </a>
                    )}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      )}

      {data.exploits.length === 0 && (
        <p className="text-sm text-cyber-muted">No known exploits found.</p>
      )}
    </div>
  );
}
